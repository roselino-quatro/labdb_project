{% extends 'base.html' %}
{% set hide_sidebar = True %}
{% set hide_navbar = True %}
{% set hide_footer = True %}
{% set main_class = 'flex min-h-screen items-center justify-center bg-gradient-to-br from-uspprimary to-uspsecondary p-6' %}
{% block title %}Register | CEFER{% endblock %}

{% block content %}
<div class="w-full max-w-lg rounded-lg bg-white p-8 shadow-xl">
    <div class="mb-6 text-center">
        <span class="inline-flex h-12 w-12 items-center justify-center rounded-full bg-uspprimary text-xl font-bold text-white">CE</span>
        <h1 class="mt-4 text-2xl font-bold text-gray-900">Create your access</h1>
        <p class="mt-2 text-sm text-gray-500">All validations occur inside SQL, ensuring centralized governance.</p>
    </div>
    <form method="post" action="{{ url_for('auth.register') }}" class="space-y-4">
        <div class="grid gap-4 md:grid-cols-2">
            <div>
                <label for="cpf" class="mb-1 block text-sm font-medium text-gray-700">CPF (numbers only)</label>
                <input id="cpf"
                       name="cpf"
                       type="text"
                       value="{{ form_data.cpf if form_data else '' }}"
                       required
                       class="w-full rounded border border-gray-300 px-4 py-2 text-sm shadow-sm focus:border-uspprimary focus:outline-none focus:ring-1 focus:ring-uspprimary"
                       placeholder="00000000000" />
            </div>
            <div>
                <label for="email" class="mb-1 block text-sm font-medium text-gray-700">Institutional email</label>
                <input id="email"
                       name="email"
                       type="email"
                       value="{{ form_data.email if form_data else '' }}"
                       required
                       class="w-full rounded border border-gray-300 px-4 py-2 text-sm shadow-sm focus:border-uspprimary focus:outline-none focus:ring-1 focus:ring-uspprimary"
                       placeholder="name.surname@usp.br" />
            </div>
        </div>
        <div>
            <label for="password" class="mb-1 block text-sm font-medium text-gray-700">Password</label>
            <input id="password"
                   name="password"
                   type="password"
                   required
                   minlength="8"
                   class="w-full rounded border border-gray-300 px-4 py-2 text-sm shadow-sm focus:border-uspprimary focus:outline-none focus:ring-1 focus:ring-uspprimary"
                   placeholder="Create a strong password" />
        </div>
        <button type="submit" class="w-full rounded bg-uspprimary px-4 py-2 text-sm font-semibold text-white transition hover:bg-uspsecondary hover:text-uspprimary">
            Register and continue
        </button>
    </form>
    <div class="mt-6 rounded-lg bg-gray-50 p-4 text-sm text-gray-600">
        <h2 class="mb-2 font-semibold text-gray-800">Registration checklist</h2>
        <ul class="list-disc space-y-1 pl-5">
            <li>Your CPF must already exist in the <code>pessoa</code> table.</li>
            <li>Roles are inferred automatically from CEFER domain tables.</li>
            <li>Passwords are hashed inside PostgreSQL via <code>pgcrypto</code>.</li>
            <li>After approval you will be redirected according to your highest privilege.</li>
        </ul>
    </div>
    <div class="mt-4 text-center text-sm text-gray-600">
        Already have access?
        <a href="{{ url_for('auth.login') }}" class="font-semibold text-uspprimary hover:text-uspyellow">Back to login</a>
    </div>
</div>
{% endblock %}
