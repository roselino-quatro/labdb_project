{% extends 'base.html' %}
{% block title %}Convites Externos | Funcionário{% endblock %}

{% block content %}
<section class="space-y-6">
    <header class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
        <div>
            <h1 class="text-2xl font-semibold text-gray-900">Convites Externos</h1>
            <p class="mt-1 text-sm text-gray-500">Gerencie convites emitidos, status de aceite e autorizações.</p>
        </div>
    </header>

    <section class="rounded-lg bg-white p-6 shadow">
        <h2 class="text-lg font-semibold text-gray-900">Emitir novo convite</h2>
        <form method="post" action="{{ url_for('staff.convite_externo') if url_for else '#' }}" class="mt-4 grid gap-4 sm:grid-cols-2">
            <label class="text-sm font-medium text-gray-700">Nome do convidado
                <input type="text" name="nome" class="mt-1 w-full rounded border border-gray-300 px-3 py-2 focus:border-uspprimary focus:outline-none focus:ring-1 focus:ring-uspprimary" required />
            </label>
            <label class="text-sm font-medium text-gray-700">Documento
                <input type="text" name="documento" class="mt-1 w-full rounded border border-gray-300 px-3 py-2 focus:border-uspprimary focus:outline-none focus:ring-1 focus:ring-uspprimary" required />
            </label>
            <label class="text-sm font-medium text-gray-700">E-mail
                <input type="email" name="email" class="mt-1 w-full rounded border border-gray-300 px-3 py-2 focus:border-uspprimary focus:outline-none focus:ring-1 focus:ring-uspprimary" />
            </label>
            <label class="text-sm font-medium text-gray-700">Atividade vinculada
                <select name="atividade_id" class="mt-1 w-full rounded border border-gray-300 px-3 py-2 focus:border-uspprimary focus:outline-none focus:ring-1 focus:ring-uspprimary">
                    {% for option in atividade_options %}
                    <option value="{{ option.value }}">{{ option.label }}</option>
                    {% endfor %}
                </select>
            </label>
            <label class="sm:col-span-2 text-sm font-medium text-gray-700">Observações
                <textarea name="observacoes" rows="3" class="mt-1 w-full rounded border border-gray-300 px-3 py-2 focus:border-uspprimary focus:outline-none focus:ring-1 focus:ring-uspprimary"></textarea>
            </label>
            <div class="sm:col-span-2 flex justify-end">
                <button type="submit" class="rounded bg-uspprimary px-4 py-2 text-sm font-semibold text-white hover:bg-uspsecondary hover:text-uspprimary">Enviar convite</button>
            </div>
        </form>
    </section>

    <section class="rounded-lg bg-white p-6 shadow">
        <h2 class="text-lg font-semibold text-gray-900">Convites emitidos</h2>
        <div class="mt-4 overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200 text-sm">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-4 py-3 text-left font-semibold uppercase tracking-wide text-gray-500">Convidado</th>
                        <th class="px-4 py-3 text-left font-semibold uppercase tracking-wide text-gray-500">Atividade</th>
                        <th class="px-4 py-3 text-left font-semibold uppercase tracking-wide text-gray-500">Status</th>
                        <th class="px-4 py-3 text-left font-semibold uppercase tracking-wide text-gray-500">Emitido em</th>
                        <th class="px-4 py-3 text-right font-semibold uppercase tracking-wide text-gray-500">Ações</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-100 bg-white">
                    {% for convite in convites %}
                    <tr>
                        <td class="px-4 py-3 text-gray-800">{{ convite.nome }}</td>
                        <td class="px-4 py-3 text-gray-700">{{ convite.atividade }}</td>
                        <td class="px-4 py-3">
                            <span class="rounded bg-{{ convite.badge_color }}-100 px-2 py-1 text-xs font-semibold text-{{ convite.badge_color }}-800">{{ convite.status }}</span>
                        </td>
                        <td class="px-4 py-3 text-gray-700">{{ convite.emitido_em }}</td>
                        <td class="px-4 py-3 text-right">
                            <div class="flex justify-end space-x-2">
                                <a href="{{ convite.reenviar_url }}" class="rounded border border-gray-300 px-3 py-1 text-xs font-semibold text-gray-700 hover:bg-gray-100">Reenviar</a>
                                <a href="{{ convite.cancelar_url }}" class="rounded bg-red-500 px-3 py-1 text-xs font-semibold text-white hover:bg-red-600">Cancelar</a>
                            </div>
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="5" class="px-4 py-6 text-center text-gray-500">Nenhum convite emitido.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </section>
</section>
{% endblock %}
